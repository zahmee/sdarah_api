{"version":3,"sources":["../../src/controller/users.js"],"names":["config","db","api","get","authenticate","IsAdmin","req","res","Account","find","err","allusers","send","json","delete","remove","_id","params","id","user","message","put","findById","name","body","username","mobile","admin","superadmin","save"],"mappings":";;;;;;AAAA;;AACA;;;;AAIA;;;;kBAEe,gBAAoB;AAAA,QAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,QAATC,EAAS,QAATA,EAAS;;AAC/B,QAAIC,MAAM,sBAAV;;AAGA;AACAA,QAAIC,GAAJ,CAAQ,GAAR,EAAaC,4BAAb,EAA2BC,uBAA3B,EAAoC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC9CC,0BAAQC,IAAR,CAAa,EAAb,EAAiB,UAACC,GAAD,EAAKC,QAAL,EAAgB;AAC7B,gBAAID,GAAJ,EAAS;AACLH,oBAAIK,IAAJ,CAASF,GAAT;AACH;AACDH,gBAAIM,IAAJ,CAASF,QAAT;AACH,SALD;AAMH,KAPD;;AASA;AACAT,QAAIY,MAAJ,CAAW,MAAX,EAAmBV,4BAAnB,EAAiCC,uBAAjC,EAA0C,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpDC,0BAAQO,MAAR,CAAe,EAAEC,KAAKV,IAAIW,MAAJ,CAAWC,EAAlB,EAAf,EAAuC,UAACR,GAAD,EAAMS,IAAN,EAAe;AAClD,gBAAIT,GAAJ,EAAS;AACLH,oBAAIK,IAAJ,CAASF,GAAT;AACH;AACDH,gBAAIM,IAAJ,CAAS,EAAEO,SAAS,QAAX,EAAT;AACH,SALD;AAMH,KAPD;;AASA;AACAlB,QAAImB,GAAJ,CAAQ,MAAR,EAAgBjB,4BAAhB,EAA8BC,uBAA9B,EAAyC,UAACC,GAAD,EAAMC,GAAN,EAAc;AACnDC,0BAAQc,QAAR,CAAiBhB,IAAIW,MAAJ,CAAWC,EAA5B,EAAgC,UAACR,GAAD,EAAMS,IAAN,EAAe;AAC3C,gBAAIT,GAAJ,EAAS;AACLH,oBAAIK,IAAJ,CAASF,GAAT;AACH;AACDS,iBAAKI,IAAL,GAAYjB,IAAIkB,IAAJ,CAASD,IAArB;AACAJ,iBAAKM,QAAL,GAAgBnB,IAAIkB,IAAJ,CAASC,QAAzB;AACAN,iBAAKO,MAAL,GAAcpB,IAAIkB,IAAJ,CAASE,MAAvB;AACAP,iBAAKQ,KAAL,GAAarB,IAAIkB,IAAJ,CAASG,KAAtB;AACAR,iBAAKS,UAAL,GAAkBtB,IAAIkB,IAAJ,CAASI,UAA3B;AACAT,iBAAKU,IAAL,CAAU,eAAO;AACb,oBAAInB,GAAJ,EAAS;AACLH,wBAAIK,IAAJ,CAASF,GAAT;AACH;AACDH,oBAAIM,IAAJ,CAAS,EAAEO,SAAS,QAAX,EAAT;AACH,aALD;AAMH,SAfD;AAgBH,KAjBD;AAkBA;AACA,WAAOlB,GAAP;AACH,C;AAlDD;AACA","file":"users.js","sourcesContent":["import { Router } from \"express\";\r\nimport Account from \"../model/account\";\r\n// import passport from \"passport\";\r\n// import config from \"../config/\";\r\n\r\nimport { respond, authenticate, IsAdmin } from \"../middleware/authMiddleware\";\r\n\r\nexport default ({ config, db }) => {\r\n    let api = Router();\r\n\r\n\r\n    //   v1/users/              ->   git all users\r\n    api.get(\"/\", authenticate, IsAdmin, (req, res) => {\r\n        Account.find({}, (err,allusers)=>{\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json(allusers);\r\n        });\r\n    });\r\n\r\n    // v1/users/:id            -> delete user by id\r\n    api.delete(\"/:id\", authenticate, IsAdmin, (req, res) => {\r\n        Account.remove({ _id: req.params.id }, (err, user) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            res.json({ message: \"remove\" });\r\n        });\r\n    });\r\n\r\n    // /v1/users/:id    --> edit user data\r\n    api.put(\"/:id\", authenticate, IsAdmin ,  (req, res) => {\r\n        Account.findById(req.params.id, (err, user) => {\r\n            if (err) {\r\n                res.send(err);\r\n            }\r\n            user.name = req.body.name;\r\n            user.username = req.body.username;\r\n            user.mobile = req.body.mobile;\r\n            user.admin = req.body.admin;\r\n            user.superadmin = req.body.superadmin;\r\n            user.save(err => {\r\n                if (err) {\r\n                    res.send(err);\r\n                }\r\n                res.json({ message: \"update\" });\r\n            });\r\n        });\r\n    });\r\n    // <========================================================> \\\\\r\n    return api;\r\n};\r\n"]}